<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wake Up - Detección de Necesidades Formativas</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .fade-in { animation: fadeIn 0.5s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .progress-bar { transition: width 0.3s ease; }
        /* Color corporativo Wake Up */
        .bg-wakeup-red { background-color: #E11D48; } 
        .text-wakeup-white { color: #FFFFFF; }
    </style>
</head>
<body class="bg-slate-50 min-h-screen">

    <div id="app" class="max-w-3xl mx-auto py-10 px-4">
        <!-- Header con colores corporativos -->
        <div class="bg-wakeup-red rounded-2xl shadow-lg p-8 mb-8 text-center border border-red-700">
            <div class="inline-block bg-white text-rose-600 font-bold px-4 py-1 rounded-full text-sm mb-4 uppercase tracking-widest shadow-sm">Wake Up</div>
            <h1 class="text-3xl font-bold text-white mb-2">Análisis de Necesidades Formativas</h1>
            <p class="text-red-100 italic opacity-90">Cliente: Clínica Rozalén</p>
        </div>

        <!-- Progress Bar -->
        <div class="mb-8 px-2">
            <div class="flex justify-between text-xs font-semibold text-slate-400 mb-2 uppercase tracking-tighter">
                <span id="progress-text">Pregunta 1 de 32</span>
                <span id="progress-percent">0%</span>
            </div>
            <div class="w-full bg-slate-200 rounded-full h-2">
                <div id="progress-bar" class="bg-wakeup-red h-2 rounded-full progress-bar" style="width: 3.12%"></div>
            </div>
        </div>

        <!-- Question Container -->
        <div id="question-card" class="bg-white rounded-2xl shadow-md p-8 border border-slate-100 fade-in">
            <h2 id="question-title" class="text-xl font-semibold text-slate-800 mb-6 leading-tight">Cargando pregunta...</h2>
            
            <div id="options-container" class="space-y-3">
                <!-- Options will be injected here -->
            </div>

            <div id="text-container" class="hidden">
                <textarea id="additional-comments" class="w-full h-32 p-4 border-2 border-slate-100 rounded-xl focus:border-rose-600 focus:ring-2 focus:ring-rose-100 outline-none transition-all text-slate-700" placeholder="Escriba aquí cualquier observación o necesidad no mencionada anteriormente..."></textarea>
            </div>
            
            <div class="mt-8 flex justify-between">
                <button id="prev-btn" class="px-6 py-2 text-slate-500 font-medium hover:text-rose-600 transition-colors hidden">Anterior</button>
                <button id="next-btn" class="ml-auto bg-slate-800 text-white px-8 py-2 rounded-lg font-semibold hover:bg-slate-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed" disabled>Siguiente</button>
            </div>
        </div>

        <!-- Results Section -->
        <div id="results-card" class="hidden bg-white rounded-2xl shadow-md p-8 text-center border border-slate-100 fade-in">
            <div class="w-20 h-20 bg-green-100 text-green-600 rounded-full flex items-center justify-center mx-auto mb-6">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                </svg>
            </div>
            <h2 class="text-2xl font-bold text-slate-800 mb-4">Análisis Finalizado</h2>
            <p class="text-slate-600 mb-8">Gracias por su tiempo. Hemos recopilado toda la información necesaria para diseñar su plan formativo a medida.</p>
            <button id="download-pdf" class="bg-wakeup-red text-white px-10 py-4 rounded-xl font-bold hover:bg-rose-700 transition-all flex items-center justify-center mx-auto shadow-lg shadow-rose-200">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                </svg>
                Descargar Informe de Resultados (PDF)
            </button>
        </div>
    </div>

    <script>
        const questions = [
            // Tipología
            { q: "¿Cuál es el perfil mayoritario de la plantilla que requiere formación?", area: "Personal", options: ["Fisioterapeutas y personal clínico", "Personal de Administración y Recepción", "Equipo Directivo y Mandos Intermedios", "Personal Auxiliar y de Apoyo"] },
            { q: "¿Qué porcentaje aproximado de la plantilla es personal sanitario especializado?", area: "Personal", options: ["Más del 75%", "Entre el 50% y 75%", "Entre el 25% y 50%", "Menos del 25%"] },
            { q: "¿Tienen perfiles con necesidades de formación técnica específica (ej. suelo pélvico, neurología)?", area: "Personal", options: ["Sí, la gran mayoría", "Solo perfiles clave", "No, buscamos formación generalista", "Explorando nuevas áreas"] },

            // Idiomas
            { q: "¿En qué medida ve necesario mejorar el nivel de inglés en recepción?", area: "Idiomas", options: ["Muy necesario", "Necesario", "Poco necesario", "No es necesario"] },
            { q: "¿Considera útil implementar formación en un segundo idioma extranjero (Francés, Alemán, Ruso)?", area: "Idiomas", options: ["Sí, hay demanda", "Sería un valor añadido", "No es prioridad", "No recibimos esos perfiles"] },
            { q: "¿Interés en idiomas para terminología médica/fisioterapia?", area: "Idiomas", options: ["Prioritario", "A medio plazo", "Solo departamentos específicos", "No por ahora"] },
            
            // Normativa
            { q: "¿Dispone de Plan de Igualdad actualizado y formación realizada?", area: "Igualdad", options: ["Al día", "Plan hecho, falta formación", "Sin plan ni formación", "En proceso"] },
            { q: "¿Necesitan actualización en Prevención de Riesgos Laborales (PRL)?", area: "Obligatorio", options: ["Urgente", "Recomendable", "Estamos al día", "No prioritario"] },
            { q: "¿Preparación ante ataques de Ciberseguridad (Phishing, datos médicos)?", area: "Ciberseguridad", options: ["Preparados", "Nociones básicas", "Requieren formación", "Riesgo no abordado"] },
            { q: "¿Certificación en Soporte Vital Básico y uso de DESA?", area: "Salud", options: ["Todos certificados", "Solo personal clínico", "Necesitamos certificar al equipo", "No disponemos de ello"] },

            // Administración
            { q: "¿Facturación y gestión de expedientes podrían ser más ágiles con formación?", area: "Admin", options: ["Totalmente", "En algunos puntos", "No es prioridad", "Satisfechos"] },
            { q: "¿Dominio del CRM y gestión de citas?", area: "Admin", options: ["Experto", "Mejorable", "Básico", "Necesita formación"] },
            { q: "¿Cumplimiento de RGPD en salud?", area: "Admin", options: ["Totalmente", "Parcial", "Necesitan actualización", "Desconocen detalles"] },

            // Marketing
            { q: "¿Habilidades para cierre de presupuestos de tratamientos largos?", area: "Comercial", options: ["Excelentes", "Faltan técnicas", "Requieren formación", "No es su función"] },
            { q: "¿Gestión de reseñas y reputación online?", area: "Marketing", options: ["Profesional", "Ocasional", "No sabemos cómo", "No interesa"] },
            { q: "¿Interés en Marketing Digital para captación?", area: "Marketing", options: ["Muy interesados", "Algo", "Futuro", "No"] },

            // IA
            { q: "¿Considera útil formar al personal en herramientas de Inteligencia Artificial para optimizar tiempos (IA generativa para informes, atención al cliente o gestión)?", area: "Innovación", options: ["Muy interesado", "Interesado para puestos clave", "Curiosidad, pero no urgente", "No lo vemos útil ahora"] },

            // Clínica Específicas
            { q: "¿Actualización en técnicas avanzadas de Fisioterapia?", area: "Clínica", options: ["Imprescindible", "Recomendable", "Especialistas concretos", "No necesario"] },
            { q: "¿Formación en análisis de la pisada (Podología)?", area: "Clínica", options: ["Sí, todo el equipo", "Solo especialista", "Ya actualizados", "No contemplado"] },
            { q: "¿Interés en abordaje biopsicosocial del dolor crónico?", area: "Clínica", options: ["Mucho", "Moderado", "Poco", "Nada"] },

            // Soft Skills
            { q: "¿Capacidad de resolución de conflictos con pacientes?", area: "Habilidades", options: ["Excelente", "Buena", "Mejorable", "Deficiente"] },
            { q: "¿Necesidad de liderazgo para responsables?", area: "Habilidades", options: ["Urgente", "Recomendable", "No prioritario", "No necesario"] },
            { q: "¿Coordinación entre departamentos?", area: "Habilidades", options: ["Sinergia total", "Buena", "Falta coordinación", "Aislados"] },
            { q: "¿Gestión de estrés y burnout?", area: "Habilidades", options: ["Fundamental", "Útil", "No necesario", "Ya trabajado"] },

            // Digital
            { q: "¿Dominio de Office para informes?", area: "Digital", options: ["Avanzado", "Medio", "Básico", "Necesitan aprender"] },
            { q: "¿Telemedicina o consultas online?", area: "Digital", options: ["Ya se hace", "Queremos aprender", "No encaja", "No"] },

            // General
            { q: "¿Principal objetivo formativo?", area: "General", options: ["Excelencia en trato", "Técnicas clínicas", "Eficiencia admin", "Crecimiento comercial"] },
            { q: "¿Modalidad preferida?", area: "General", options: ["Presencial", "Online", "Mixta", "Cápsulas cortas"] },
            { q: "¿Disponibilidad horaria?", area: "General", options: ["Mañanas", "Tardes", "Mediodía", "Fines de semana"] },
            { q: "¿Formación actual suficiente?", area: "General", options: ["Totalmente", "Mejorable", "Insuficiente", "No lo sé"] },
            { q: "¿Grado de compromiso del personal?", area: "General", options: ["Muy alto", "Medio", "Bajo", "Solo obligatoria"] },
            
            // Comentarios
            { q: "¿Desea añadir algún comentario adicional o necesidad específica para Wake Up?", area: "Observaciones", type: "text" }
        ];

        let currentQuestion = 0;
        let answers = [];

        const qTitle = document.getElementById('question-title');
        const optionsContainer = document.getElementById('options-container');
        const textContainer = document.getElementById('text-container');
        const textField = document.getElementById('additional-comments');
        const nextBtn = document.getElementById('next-btn');
        const prevBtn = document.getElementById('prev-btn');
        const progressText = document.getElementById('progress-text');
        const progressPercent = document.getElementById('progress-percent');
        const progressBar = document.getElementById('progress-bar');
        const questionCard = document.getElementById('question-card');
        const resultsCard = document.getElementById('results-card');

        function loadQuestion() {
            const q = questions[currentQuestion];
            qTitle.innerText = `${currentQuestion + 1}. ${q.q}`;
            
            if (q.type === "text") {
                optionsContainer.classList.add('hidden');
                textContainer.classList.remove('hidden');
                nextBtn.disabled = false;
                nextBtn.innerText = "Finalizar";
                textField.focus();
            } else {
                optionsContainer.classList.remove('hidden');
                textContainer.classList.add('hidden');
                optionsContainer.innerHTML = '';
                
                q.options.forEach((option) => {
                    const btn = document.createElement('button');
                    btn.className = `w-full text-left p-4 rounded-xl border-2 transition-all duration-200 flex items-center group ${
                        answers[currentQuestion] === option 
                        ? 'border-rose-600 bg-rose-50 text-rose-800 ring-2 ring-rose-100' 
                        : 'border-slate-100 hover:border-slate-300 hover:bg-slate-50 text-slate-700'
                    }`;
                    btn.innerHTML = `
                        <div class="w-5 h-5 rounded-full border-2 mr-4 flex-shrink-0 flex items-center justify-center ${answers[currentQuestion] === option ? 'border-rose-600 bg-rose-600' : 'border-slate-300'}">
                            ${answers[currentQuestion] === option ? '<div class="w-2 h-2 bg-white rounded-full"></div>' : ''}
                        </div>
                        <span>${option}</span>
                    `;
                    btn.onclick = () => {
                        answers[currentQuestion] = option;
                        loadQuestion();
                    };
                    optionsContainer.appendChild(btn);
                });
                nextBtn.innerText = "Siguiente";
                nextBtn.disabled = !answers[currentQuestion];
            }

            updateProgress();
            prevBtn.classList.toggle('hidden', currentQuestion === 0);
        }

        function updateProgress() {
            const percent = Math.round(((currentQuestion) / (questions.length)) * 100);
            progressText.innerText = `Pregunta ${currentQuestion + 1} de ${questions.length}`;
            progressPercent.innerText = `${percent}%`;
            progressBar.style.width = `${percent}%`;
        }

        nextBtn.onclick = () => {
            if (questions[currentQuestion].type === "text") {
                answers[currentQuestion] = textField.value || "Sin comentarios";
                showResults();
                return;
            }
            if (currentQuestion < questions.length - 1) {
                currentQuestion++;
                loadQuestion();
            }
        };

        prevBtn.onclick = () => {
            if (currentQuestion > 0) {
                currentQuestion--;
                loadQuestion();
            }
        };

        function showResults() {
            questionCard.classList.add('hidden');
            resultsCard.classList.remove('hidden');
            progressBar.style.width = '100%';
            progressPercent.innerText = '100%';
        }

        document.getElementById('download-pdf').onclick = function() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            const date = new Date().toLocaleDateString();

            doc.setFillColor(225, 29, 72); // Wake Up Red
            doc.rect(0, 0, 210, 40, 'F');
            doc.setTextColor(255, 255, 255);
            doc.setFontSize(22);
            doc.text("WAKE UP - Auditoría Formativa", 20, 20);
            doc.setFontSize(10);
            doc.text(`Cliente: Clínica Rozalén | Fecha: ${date}`, 20, 30);

            doc.setTextColor(40, 40, 40);
            let y = 50;
            
            questions.forEach((q, i) => {
                if (y > 270) { doc.addPage(); y = 20; }
                doc.setFont(undefined, 'bold');
                doc.setFontSize(9);
                const titleLines = doc.splitTextToSize(`${i + 1}. ${q.q}`, 175);
                doc.text(titleLines, 20, y);
                y += (titleLines.length * 5);
                
                doc.setFont(undefined, 'normal');
                doc.setTextColor(225, 29, 72); // Texto de respuesta en rojo corporativo
                const ansLines = doc.splitTextToSize(`Respuesta: ${answers[i] || 'No respondido'}`, 170);
                doc.text(ansLines, 25, y);
                doc.setTextColor(40, 40, 40);
                y += (ansLines.length * 5) + 3;
            });

            doc.save(`Auditoria_WakeUp_Rozalen_${date.replace(/\//g, '-')}.pdf`);
        };

        loadQuestion();
    </script>
</body>
</html>